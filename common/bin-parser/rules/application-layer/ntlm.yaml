Package:
  NegotiateMessage:
    Signature: raw,8
    MessageType: uint32
    NegotiateFlags: uint32
    DomainNameFields:
      DomainNameLen: uint16
      DomainNameMaxLen: uint16
      DomainNameBufferOffset: uint32
    WorkstationFields:
      WorkstationLen: uint16
      WorkstationMaxLen: uint16
      WorkstationBufferOffset: uint32
    Version:
      ProductMajorVersion: uint8
      ProductMinorVersion: uint8
      ProductBuild: uint16
      Reserved: raw,3
      NTLMRevisionCurrent: uint8
#    Payload: raw,1

  ChallengeMessage:
    Signature: raw,8
    MessageType: raw,4
    TargetNameFields: raw,8
    NegotiateFlags: raw,4
    ServerChallenge: raw,8
    Reserved: raw,8
    TargetInfoFields: raw,8

  AuthenticationMessage:
    Signature: raw,8
    MessageType: raw,4
    LmChallengeResponseFields: raw,8
    NtChallengeResponseFields: raw,8
    DomainNameFields: raw,8
    UserNameFields: raw,8
    WorkstationFields: raw,8
    EncryptedRandomSessionKeyFields: raw,8
